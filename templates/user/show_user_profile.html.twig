{% extends 'base.html.twig' %}

{% block title %}profile{% endblock %}
{# page de profil d'un uttilisateur seul lui meme peux y accèder #}
{% block body %}
{% set scoretotal = 0 %} {# variable déclarer pour le calcul du score total #}
{# pour le numéro du quiz #}
{% set nb = 1 %} 

    <div class="container-profil">
        <div class="topper">
            <h2 class="title_profil">Profil Utilisateur</h2>
        </div> 
            <section class="edit_profil">
                <section class="section_profil">  
                        <h2 class="profil-info">{{ app.user.username|upper }}</h2>
                    {# nombre de quiz creer pour cet utilisateur + bouton voir liste de tous ses quiz #}
                </section> {# fin section <section id="section_profil"> #}

                <div class="personal">
                    <section class="box_mail">
                        <h2 class="email">Email:</h2>
                        <p class='email'>{{ app.user.email }}</p>
                    </section>
                </div>
                {# lien vers le formulaire de modification de profil(username, email, image) #}
                <a class="btn_edit_profil" href="{{path('edit_profile', {'id': app.user.id})}}">Modifier profil</a>
            </section>
        <div class="points">
            {% for game in app.user.games %}
                {# calcul pour le score total  #}
                {% set scoretotal = scoretotal + game.score %}

            {% endfor %}
                {# affichage du score total  #}
            <h4 class="score">{{ scoretotal }}</h4>
            <p class="info_score">Score Total</p>
        </div>

        <div class="deal">
            <h3 class="best_score">Mes 3 meilleurs scores :</h3>
            {% for bestGame in games %}

                <p><span class="profil-info">{{ nb }} :</span> {{ bestGame.quiz.title }} score: {{ bestGame.score }}</p>

                {% set nb = nb + 1 %} 

            {% endfor %}
        </div>

        <div class="recent">
            <div>
                <h3 class="recent_acti">Recent Activity</h3>

                <ul class="list_profil">
                    {% for game in gamesUser %}
                        <li class="game_quiz"> {{ game.quiz.title }} <span class="game_score"> {{ game.score }}</span></li>
                    {% endfor %}
                </ul>  

            </div>

        </div>

        <div class="bought">

            <div>
                <h3 class="create_quiz">Vos Quiz créer</h3>
                {# condition si l'utilisateur a créer un quiz ou non  #}
                    {% if not app.user.quizzes|length == 0  %}
                    
                    <ul class="list_profil" >

                        {# boucle pour afficher les quiz de cet utilisateur #}
                        {% for quiz in app.user.quizzes %} 
                           
                                <li class="profil_quiz_info">{{ quiz.title }} <span> nombre de question: {{quiz.questions|length}}</span><a class="btn_edit_quiz" href="{{path('new_question', {'idQuiz': quiz.id})}}">Modifier Quiz</a></li>
                           
                        {% endfor %}
                    </ul>

                {% else %}

                    {# message si aucun quiz créer  #}
                    <ul id="list-quiz">   
                        Vous n'avez pas créer de quiz pour le moment
                    </ul>

                {% endif %}
                

            </div>
        </div>
    </div>   
     
{% endblock %}